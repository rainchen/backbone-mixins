// Generated by CoffeeScript 1.7.1

/*
class TodosRouter extends Backbone.Router
  _.extend @::, Backbone.Mixins.RouteFilter

  initialize: (options) ->
    @todos = new TodosCollection()

    @on 'before:route:index', =>
      @todos.fetch(reset: true) if !@todos.any()

    @on 'before:route:show before:route:edit', @findTodo

    @on 'after:route:show', -> console.info 'todo is shown'

  findTodo: (id)->
    if !@todos.get(id)
      @halt() # stop the original route callback and after filter from running
      if !@todos.any()
        @todos.fetch
          success: =>
            if @todos.get(id)
              @resume() # continue the original route callback and after filter from running
 */
Backbone.Mixins || (Backbone.Mixins = {});

Backbone.Mixins.RouteFilter = {
  route: function(route, name, callback) {
    return Backbone.Router.prototype.route.call(this, route, name, function() {
      this._halted = false;
      this.trigger.apply(this, ["before:route:" + name].concat(_.toArray(arguments)));
      if (this._halted === true) {
        this._halted = {
          name: name,
          "arguments": arguments
        };
      } else {
        if (!callback) {
          callback = this[name];
        }
        if (callback != null) {
          callback.apply(this, arguments);
        }
        this.trigger.apply(this, ["after:route:" + name].concat(_.toArray(arguments)));
      }
      return this;
    });
  },
  halt: function() {
    return this._halted = true;
  },
  resume: function() {
    var callback;
    if (this._halted && this._halted.name) {
      callback = this[this._halted.name];
      if (callback != null) {
        callback.apply(this, this._halted["arguments"]);
      }
    }
    return this._halted = false;
  }
};
